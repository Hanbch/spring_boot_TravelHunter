<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="edu.hi.prj.mapper.BoardMapper">
    
    <select id="getList" resultType="BoardVO">
       <![CDATA[ 
           select * from board
       ]]>
    </select>
    
    <select id="searchList" resultType="BoardVO">
       <![CDATA[ 
           select * from board  where member_id = #{member_id}
       ]]>
    </select>
    
    <select id="getBoard" resultType="BoardVO">
       <![CDATA[
           select * from board where id = #{id}
       ]]>
    </select>
    
    <insert id="insert" >
       <![CDATA[
           insert into board (id, member_id, btitle, bcontent, place_num, board_type_num, bgrade, bview)
            values (board_seq.nextval, #{member_id}, #{btitle}, #{bcontent}, #{place_num}, #{board_type_num}, bgrade_seq.currval, bview_seq.currval)
       ]]>
    </insert>
    
    <update id="update" >
    	<![CDATA[
    		update board set member_id=#{member_id}, btitle=#{btitle}, bcontent=#{bcontent}
          	where id =#{id}
    	]]>
    </update>
    
    <delete id="delete" >
    	<![CDATA[
    		delete from board where id = #{id}
    	]]>
    </delete>
    
   
   
   <insert id="insertReply" >
   <![CDATA[
      insert into board (id, member_id, btitle, bcontent, place_num, board_type_num, bgrade, bview) 
      values (mvc_board_seq.nextval, #{member_id}, #{btitle},#{bcontent}, 
                #{place_num}, #{board_type_num}, #{bgrade}, #{bview}+1)
   ]]>
   </insert>
   
   <update id="updateHit">
      <![CDATA[
          update board set bhit = bhit + 1 where bid = #{bid}
      ]]>
   </update>
   
   <select id="getTotalCount" resultType="int">
       <![CDATA[
           select count(*) from board
       ]]>
    </select>
    
    <select id="getListWithPaging" resultType="BoardVO">
      <![CDATA[
        SELECT * FROM (
              SELECT ROWNUM AS RNUM, A.* FROM (
                       SELECT
                             *
                         FROM
                             mvc_board 
                         order by bGroup desc, bStep asc   
             ) A WHERE ROWNUM <= #{pageNum} * #{amount}
         ) WHERE RNUM > (#{pageNum}-1) * #{amount}
      ]]>
   </select>
    
</mapper>
